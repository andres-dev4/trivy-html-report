{
  "SchemaVersion": 2,
  "CreatedAt": "2024-12-05T22:53:47.514235383-06:00",
  "ArtifactName": "..",
  "ArtifactType": "filesystem",
  "Metadata": {
    "ImageConfig": {
      "architecture": "",
      "created": "0001-01-01T00:00:00Z",
      "os": "",
      "rootfs": {
        "type": "",
        "diff_ids": null
      },
      "config": {}
    }
  },
  "Results": [
    {
      "Target": "src/Pipfile.lock",
      "Class": "lang-pkgs",
      "Type": "pipenv",
      "Vulnerabilities": [
        {
          "VulnerabilityID": "CVE-2022-42966",
          "PkgName": "cleo",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/cleo@1.0.0a4",
            "UID": "7226fc2cccc60775"
          },
          "InstalledVersion": "1.0.0a4",
          "FixedVersion": "1.0.0",
          "Status": "fixed",
          "Layer": {},
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2022-42966",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "cleo is vulnerable to Regular Expression Denial of Service (ReDoS)",
          "Description": "An exponential ReDoS (Regular Expression Denial of Service) can be triggered in the cleo PyPI package, when an attacker is able to supply arbitrary input to the Table.set_rows method",
          "Severity": "MEDIUM",
          "CweIDs": [
            "CWE-1333"
          ],
          "VendorSeverity": {
            "ghsa": 2,
            "nvd": 3
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 5.9
            },
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 7.5
            }
          },
          "References": [
            "https://github.com/python-poetry/cleo",
            "https://github.com/python-poetry/cleo/commit/b5b9a04d2caf58bf7cf94eb7ae4a1ebbe60ea455",
            "https://github.com/python-poetry/cleo/pull/285",
            "https://nvd.nist.gov/vuln/detail/CVE-2022-42966",
            "https://research.jfrog.com/vulnerabilities/cleo-redos-xray-257186",
            "https://research.jfrog.com/vulnerabilities/cleo-redos-xray-257186/"
          ],
          "PublishedDate": "2022-11-09T20:15:10.993Z",
          "LastModifiedDate": "2023-07-06T13:55:56.207Z"
        },
        {
          "VulnerabilityID": "CVE-2024-22513",
          "PkgName": "djangorestframework-simplejwt",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/djangorestframework-simplejwt@5.3.1",
            "UID": "31be19f4ac3524c3"
          },
          "InstalledVersion": "5.3.1",
          "Status": "affected",
          "Layer": {},
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-22513",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "djangorestframework-simplejwt: information disclosure vulnerability",
          "Description": "djangorestframework-simplejwt version 5.3.1 and before is vulnerable to information disclosure. A user can access web application resources even after their account has been disabled due to missing user validation checks via the for_user method.",
          "Severity": "LOW",
          "CweIDs": [
            "CWE-306"
          ],
          "VendorSeverity": {
            "ghsa": 1,
            "redhat": 2
          },
          "CVSS": {
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
              "V3Score": 5.5
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2024-22513",
            "https://github.com/dmdhrumilmistry/CVEs/tree/main/CVE-2024-22513",
            "https://github.com/jazzband/djangorestframework-simplejwt",
            "https://github.com/jazzband/djangorestframework-simplejwt/blob/c791e987332ed5e22a86428160d6372b1d85ffae/rest_framework_simplejwt/tokens.py#L281",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-22513",
            "https://www.cve.org/CVERecord?id=CVE-2024-22513"
          ],
          "PublishedDate": "2024-03-16T07:15:06.513Z",
          "LastModifiedDate": "2024-11-01T20:35:06.28Z"
        },
        {
          "VulnerabilityID": "CVE-2024-3772",
          "PkgName": "pydantic",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/pydantic@1.10.1",
            "UID": "b08018dd5498fb56"
          },
          "InstalledVersion": "1.10.1",
          "FixedVersion": "2.4.0, 1.10.13",
          "Status": "fixed",
          "Layer": {},
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-3772",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "python-pydantic: regular expression denial of service via crafted email string",
          "Description": "Regular expression denial of service in Pydanic \u003c 2.4.0, \u003c 1.10.13 allows remote attackers to cause denial of service via a crafted email string.\n",
          "Severity": "MEDIUM",
          "CweIDs": [
            "CWE-1333"
          ],
          "VendorSeverity": {
            "ghsa": 2,
            "redhat": 2,
            "ubuntu": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 5.9
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 5.9
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2024-3772",
            "https://github.com/pydantic/pydantic",
            "https://github.com/pydantic/pydantic/commit/59d8f38fd6220e3917c53785dbc70317d6f8e631",
            "https://github.com/pydantic/pydantic/commit/59d8f38fd6220e3917c53785dbc70317d6f8e631 (v1.0.13)",
            "https://github.com/pydantic/pydantic/commit/e4393ae6145c4dadff739990bb0116c6dec3441b",
            "https://github.com/pydantic/pydantic/commit/e4393ae6145c4dadff739990bb0116c6dec3441b (v2.4.0)",
            "https://github.com/pydantic/pydantic/pull/7360",
            "https://github.com/pydantic/pydantic/pull/7673",
            "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/6JBZLMSH4GAZOVBMT2JUO2LXHY7M2ALI",
            "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/6JBZLMSH4GAZOVBMT2JUO2LXHY7M2ALI/",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-3772",
            "https://ubuntu.com/security/notices/USN-7101-1",
            "https://www.cve.org/CVERecord?id=CVE-2024-3772"
          ],
          "PublishedDate": "2024-04-15T03:16:07.987Z",
          "LastModifiedDate": "2024-04-26T02:15:06.983Z"
        },
        {
          "VulnerabilityID": "CVE-2024-53861",
          "PkgName": "pyjwt",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/pyjwt@2.10.0",
            "UID": "4b0f5a661ede93c3"
          },
          "InstalledVersion": "2.10.0",
          "FixedVersion": "2.10.1",
          "Status": "fixed",
          "Layer": {},
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-53861",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "pyjwt: Issuer field partial matches allowed in pyjwt",
          "Description": "pyjwt is a JSON Web Token implementation in Python. An incorrect string comparison is run for `iss` checking, resulting in `\"acb\"` being accepted for `\"_abc_\"`. This is a bug introduced in version 2.10.0: checking the \"iss\" claim changed from `isinstance(issuer, list)` to `isinstance(issuer, Sequence)`. Since str is a Sequnce, but not a list, `in` is also used for string comparison. This results in `if \"abc\" not in \"__abcd__\":` being checked instead of `if \"abc\" != \"__abc__\":`. Signature checks are still present so real world impact is likely limited to denial of service scenarios. This issue has been patched in version 2.10.1. All users are advised to upgrade. There are no known workarounds for this vulnerability.",
          "Severity": "LOW",
          "CweIDs": [
            "CWE-697"
          ],
          "VendorSeverity": {
            "ghsa": 1,
            "redhat": 1
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:N/I:L/A:N",
              "V3Score": 2.2
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:N/I:N/A:L",
              "V3Score": 2.2
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2024-53861",
            "https://github.com/jpadilla/pyjwt",
            "https://github.com/jpadilla/pyjwt/commit/1570e708672aa9036bc772476beae8bfa48f4131#diff-6893ad4a1c5a36b8af3028db8c8bc3b62418149843fc382faf901eaab008e380R366",
            "https://github.com/jpadilla/pyjwt/commit/33022c25525c1020869c71ce2a4109e44ae4ced1",
            "https://github.com/jpadilla/pyjwt/security/advisories/GHSA-75c5-xw7c-p5pm",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-53861",
            "https://www.cve.org/CVERecord?id=CVE-2024-53861"
          ],
          "PublishedDate": "2024-11-29T19:15:09.433Z",
          "LastModifiedDate": "2024-12-02T19:15:12.15Z"
        }
      ]
    },
    {
      "Target": "Dockerfile",
      "Class": "config",
      "Type": "dockerfile",
      "MisconfSummary": {
        "Successes": 24,
        "Failures": 5,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS005",
          "AVDID": "AVD-DS-0005",
          "Title": "ADD instead of COPY",
          "Description": "You should use COPY instead of ADD unless you want to extract a tar file. Note that an ADD command will extract a tar file, which adds the risk of Zip-based vulnerabilities. Accordingly, it is advised to use a COPY command, which does not extract tar files.",
          "Message": "Consider using 'COPY odbcinst.ini /etc/' command instead of 'ADD odbcinst.ini /etc/'",
          "Namespace": "builtin.dockerfile.DS005",
          "Query": "data.builtin.dockerfile.DS005.deny",
          "Resolution": "Use COPY instead of ADD",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds005",
          "References": [
            "https://docs.docker.com/engine/reference/builder/#add",
            "https://avd.aquasec.com/misconfig/ds005"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 14,
            "EndLine": 14,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "ADD odbcinst.ini /etc/",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m\u001b[38;5;64mADD\u001b[0m odbcinst.ini /etc/",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS026",
          "AVDID": "AVD-DS-0026",
          "Title": "No HEALTHCHECK defined",
          "Description": "You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.",
          "Message": "Add HEALTHCHECK instruction in your Dockerfile",
          "Namespace": "builtin.dockerfile.DS026",
          "Query": "data.builtin.dockerfile.DS026.deny",
          "Resolution": "Add HEALTHCHECK instruction in Dockerfile",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds026",
          "References": [
            "https://blog.aquasec.com/docker-security-best-practices",
            "https://avd.aquasec.com/misconfig/ds026"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS029",
          "AVDID": "AVD-DS-0029",
          "Title": "'apt-get' missing '--no-install-recommends'",
          "Description": "'apt-get' install should use '--no-install-recommends' to minimize image size.",
          "Message": "'--no-install-recommends' flag is missed: 'apt-get update \u0026\u0026 ACCEPT_EULA=Y apt-get -y install mssql-tools msodbcsql17'",
          "Namespace": "builtin.dockerfile.DS029",
          "Query": "data.builtin.dockerfile.DS029.deny",
          "Resolution": "Add '--no-install-recommends' flag to 'apt-get'",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds029",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
            "https://avd.aquasec.com/misconfig/ds029"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 19,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "RUN apt-get update \u0026\u0026 ACCEPT_EULA=Y apt-get -y install mssql-tools msodbcsql17",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;64mRUN\u001b[0m apt-get update \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;33mACCEPT_EULA\u001b[0m\u001b[38;5;245m=\u001b[0mY apt-get -y install mssql-tools msodbcsql17",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS029",
          "AVDID": "AVD-DS-0029",
          "Title": "'apt-get' missing '--no-install-recommends'",
          "Description": "'apt-get' install should use '--no-install-recommends' to minimize image size.",
          "Message": "'--no-install-recommends' flag is missed: 'apt-get update -y \u0026\u0026 apt-get install -y curl gnupg'",
          "Namespace": "builtin.dockerfile.DS029",
          "Query": "data.builtin.dockerfile.DS029.deny",
          "Resolution": "Add '--no-install-recommends' flag to 'apt-get'",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds029",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
            "https://avd.aquasec.com/misconfig/ds029"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 15,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "RUN apt-get update -y \u0026\u0026 apt-get install -y curl gnupg",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;64mRUN\u001b[0m apt-get update -y \u001b[38;5;245m\u0026\u0026\u001b[0m apt-get install -y curl gnupg",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS029",
          "AVDID": "AVD-DS-0029",
          "Title": "'apt-get' missing '--no-install-recommends'",
          "Description": "'apt-get' install should use '--no-install-recommends' to minimize image size.",
          "Message": "'--no-install-recommends' flag is missed: 'apt-get update -y \u0026\u0026 apt-get install -y unixodbc unixodbc-dev tdsodbc freetds-common freetds-bin freetds-dev'",
          "Namespace": "builtin.dockerfile.DS029",
          "Query": "data.builtin.dockerfile.DS029.deny",
          "Resolution": "Add '--no-install-recommends' flag to 'apt-get'",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds029",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
            "https://avd.aquasec.com/misconfig/ds029"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 18,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "RUN apt-get update -y \u0026\u0026 apt-get install -y unixodbc unixodbc-dev tdsodbc freetds-common freetds-bin freetds-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;64mRUN\u001b[0m apt-get update -y \u001b[38;5;245m\u0026\u0026\u001b[0m apt-get install -y unixodbc unixodbc-dev tdsodbc freetds-common freetds-bin freetds-dev",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "src/kubernetes/dev_autoscaler_deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "src/kubernetes/dev_celery_worker.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 83,
        "Failures": 12,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'fakeapp-celery-worker-dev' of Deployment 'fakeapp-celery-worker-dev' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'fakeapp-celery-worker-dev' of Deployment 'fakeapp-celery-worker-dev' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'fakeapp-celery-worker-dev' of Deployment 'fakeapp-celery-worker-dev' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'fakeapp-celery-worker-dev' of Deployment 'fakeapp-celery-worker-dev' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'fakeapp-celery-worker-dev' of Deployment 'fakeapp-celery-worker-dev' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'fakeapp-celery-worker-dev' of Deployment 'fakeapp-celery-worker-dev' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'fakeapp-celery-worker-dev' of Deployment 'fakeapp-celery-worker-dev' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'fakeapp-celery-worker-dev' of Deployment 'fakeapp-celery-worker-dev' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'fakeapp-celery-worker-dev' of Deployment 'fakeapp-celery-worker-dev' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"fakeapp-celery-worker-dev\" of deployment \"fakeapp-celery-worker-dev\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "src/kubernetes/dev_collectstatic_job.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 81,
        "Failures": 14,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 294,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          python3 manage.py collectstatic --no-input",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          \u001b[0m          python3 manage.py collectstatic --no-input",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env: ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m: ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "          -",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          -",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 294,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          python3 manage.py collectstatic --no-input",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          \u001b[0m          python3 manage.py collectstatic --no-input",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env: ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m: ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "          -",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          -",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 294,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          python3 manage.py collectstatic --no-input",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          \u001b[0m          python3 manage.py collectstatic --no-input",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env: ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m: ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "          -",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          -",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 294,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          python3 manage.py collectstatic --no-input",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          \u001b[0m          python3 manage.py collectstatic --no-input",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env: ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m: ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "          -",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          -",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 294,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          python3 manage.py collectstatic --no-input",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          \u001b[0m          python3 manage.py collectstatic --no-input",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env: ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m: ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "          -",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          -",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 294,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          python3 manage.py collectstatic --no-input",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          \u001b[0m          python3 manage.py collectstatic --no-input",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env: ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m: ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "          -",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          -",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 294,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          python3 manage.py collectstatic --no-input",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          \u001b[0m          python3 manage.py collectstatic --no-input",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env: ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m: ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "          -",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          -",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV016",
          "AVDID": "AVD-KSV-0016",
          "Title": "Memory requests not specified",
          "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'resources.requests.memory'",
          "Namespace": "builtin.kubernetes.KSV016",
          "Query": "data.builtin.kubernetes.KSV016.deny",
          "Resolution": "Set 'containers[].resources.requests.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 294,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          python3 manage.py collectstatic --no-input",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          \u001b[0m          python3 manage.py collectstatic --no-input",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env: ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m: ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "          -",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          -",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV018",
          "AVDID": "AVD-KSV-0018",
          "Title": "Memory not limited",
          "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'resources.limits.memory'",
          "Namespace": "builtin.kubernetes.KSV018",
          "Query": "data.builtin.kubernetes.KSV018.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv018"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 294,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          python3 manage.py collectstatic --no-input",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          \u001b[0m          python3 manage.py collectstatic --no-input",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env: ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m: ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "          -",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          -",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 294,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          python3 manage.py collectstatic --no-input",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          \u001b[0m          python3 manage.py collectstatic --no-input",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env: ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m: ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "          -",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          -",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 294,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          python3 manage.py collectstatic --no-input",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          \u001b[0m          python3 manage.py collectstatic --no-input",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env: ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m: ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "          -",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          -",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 294,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          python3 manage.py collectstatic --no-input",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          \u001b[0m          python3 manage.py collectstatic --no-input",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env: ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m: ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "          -",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          -",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"collectstatic\" of job \"collectstatic-job\" in \"development-env\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 294,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          python3 manage.py collectstatic --no-input",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          \u001b[0m          python3 manage.py collectstatic --no-input",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env: ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m: ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "          -",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          -",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "src/kubernetes/dev_deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 12,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'fakeapp-backend-dev' of Deployment 'fakeapp-backend-dev' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'fakeapp-backend-dev' of Deployment 'fakeapp-backend-dev' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'fakeapp-backend-dev' of Deployment 'fakeapp-backend-dev' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'fakeapp-backend-dev' of Deployment 'fakeapp-backend-dev' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'fakeapp-backend-dev' of Deployment 'fakeapp-backend-dev' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'fakeapp-backend-dev' of Deployment 'fakeapp-backend-dev' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'fakeapp-backend-dev' of Deployment 'fakeapp-backend-dev' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'fakeapp-backend-dev' of Deployment 'fakeapp-backend-dev' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'fakeapp-backend-dev' of Deployment 'fakeapp-backend-dev' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"fakeapp-backend-dev\" of deployment \"fakeapp-backend-dev\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "src/kubernetes/dev_flower_deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 12,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'fakeapp-celery-flower-dev' of Deployment 'fakeapp-celery-flower-dev' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 238,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'fakeapp-celery-flower-dev' of Deployment 'fakeapp-celery-flower-dev' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 238,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'fakeapp-celery-flower-dev' of Deployment 'fakeapp-celery-flower-dev' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 238,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'fakeapp-celery-flower-dev' of Deployment 'fakeapp-celery-flower-dev' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 238,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'fakeapp-celery-flower-dev' of Deployment 'fakeapp-celery-flower-dev' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 238,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'fakeapp-celery-flower-dev' of Deployment 'fakeapp-celery-flower-dev' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 238,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'fakeapp-celery-flower-dev' of Deployment 'fakeapp-celery-flower-dev' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 238,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'fakeapp-celery-flower-dev' of Deployment 'fakeapp-celery-flower-dev' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 238,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'fakeapp-celery-flower-dev' of Deployment 'fakeapp-celery-flower-dev' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 238,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 238,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"fakeapp-celery-flower-dev\" of deployment \"fakeapp-celery-flower-dev\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 238,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-dev",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-dev",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_dev:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "src/kubernetes/dev_nginx_deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 14,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-dev' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-dev' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-dev' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-dev' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-dev' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-dev' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV016",
          "AVDID": "AVD-KSV-0016",
          "Title": "Memory requests not specified",
          "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-dev' should set 'resources.requests.memory'",
          "Namespace": "builtin.kubernetes.KSV016",
          "Query": "data.builtin.kubernetes.KSV016.deny",
          "Resolution": "Set 'containers[].resources.requests.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV018",
          "AVDID": "AVD-KSV-0018",
          "Title": "Memory not limited",
          "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-dev' should set 'resources.limits.memory'",
          "Namespace": "builtin.kubernetes.KSV018",
          "Query": "data.builtin.kubernetes.KSV018.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv018"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-dev' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-dev' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"nginx\" of deployment \"fake-nginx-dev\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV117",
          "AVDID": "AVD-KSV-0117",
          "Title": "Prevent binding to privileged ports",
          "Description": "The ports which are lower than 1024 receive and transmit various sensitive and privileged data. Allowing containers to use them can bring serious implications.",
          "Message": "deployment fake-nginx-dev in default namespace should not set spec.template.spec.containers.ports.containerPort to less than 1024",
          "Namespace": "builtin.kubernetes.KSV117",
          "Query": "data.builtin.kubernetes.KSV117.deny",
          "Resolution": "Do not map the container ports to privileged host ports when starting a container.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv117",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/",
            "https://avd.aquasec.com/misconfig/ksv117"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        }
      ]
    },
    {
      "Target": "src/kubernetes/dev_pvolumen_flower_fs.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "src/kubernetes/dev_pvolumen_fs.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "src/kubernetes/dev_redis_client.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 14,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'redis-web-client' of Deployment 'redis-web-client-deployment' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 24,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis-web-client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis-web-client",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: marian/rebrow",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: marian/rebrow",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 5001",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5001",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: REDIS_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_HOST",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: redis-service",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: redis-service",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: REDIS_PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"6379\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"6379\"",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'redis-web-client' of Deployment 'redis-web-client-deployment' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 24,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis-web-client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis-web-client",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: marian/rebrow",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: marian/rebrow",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 5001",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5001",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: REDIS_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_HOST",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: redis-service",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: redis-service",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: REDIS_PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"6379\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"6379\"",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'redis-web-client' of Deployment 'redis-web-client-deployment' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 24,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis-web-client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis-web-client",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: marian/rebrow",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: marian/rebrow",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 5001",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5001",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: REDIS_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_HOST",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: redis-service",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: redis-service",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: REDIS_PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"6379\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"6379\"",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'redis-web-client' of Deployment 'redis-web-client-deployment' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 24,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis-web-client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis-web-client",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: marian/rebrow",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: marian/rebrow",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 5001",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5001",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: REDIS_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_HOST",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: redis-service",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: redis-service",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: REDIS_PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"6379\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"6379\"",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'redis-web-client' of Deployment 'redis-web-client-deployment' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 24,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis-web-client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis-web-client",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: marian/rebrow",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: marian/rebrow",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 5001",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5001",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: REDIS_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_HOST",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: redis-service",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: redis-service",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: REDIS_PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"6379\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"6379\"",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'redis-web-client' of Deployment 'redis-web-client-deployment' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 24,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis-web-client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis-web-client",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: marian/rebrow",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: marian/rebrow",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 5001",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5001",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: REDIS_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_HOST",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: redis-service",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: redis-service",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: REDIS_PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"6379\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"6379\"",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'redis-web-client' of Deployment 'redis-web-client-deployment' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 24,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis-web-client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis-web-client",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: marian/rebrow",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: marian/rebrow",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 5001",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5001",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: REDIS_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_HOST",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: redis-service",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: redis-service",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: REDIS_PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"6379\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"6379\"",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV016",
          "AVDID": "AVD-KSV-0016",
          "Title": "Memory requests not specified",
          "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'redis-web-client' of Deployment 'redis-web-client-deployment' should set 'resources.requests.memory'",
          "Namespace": "builtin.kubernetes.KSV016",
          "Query": "data.builtin.kubernetes.KSV016.deny",
          "Resolution": "Set 'containers[].resources.requests.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 24,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis-web-client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis-web-client",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: marian/rebrow",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: marian/rebrow",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 5001",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5001",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: REDIS_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_HOST",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: redis-service",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: redis-service",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: REDIS_PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"6379\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"6379\"",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV018",
          "AVDID": "AVD-KSV-0018",
          "Title": "Memory not limited",
          "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
          "Message": "Container 'redis-web-client' of Deployment 'redis-web-client-deployment' should set 'resources.limits.memory'",
          "Namespace": "builtin.kubernetes.KSV018",
          "Query": "data.builtin.kubernetes.KSV018.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv018"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 24,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis-web-client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis-web-client",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: marian/rebrow",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: marian/rebrow",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 5001",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5001",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: REDIS_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_HOST",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: redis-service",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: redis-service",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: REDIS_PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"6379\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"6379\"",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'redis-web-client' of Deployment 'redis-web-client-deployment' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 24,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis-web-client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis-web-client",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: marian/rebrow",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: marian/rebrow",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 5001",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5001",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: REDIS_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_HOST",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: redis-service",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: redis-service",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: REDIS_PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"6379\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"6379\"",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'redis-web-client' of Deployment 'redis-web-client-deployment' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 24,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis-web-client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis-web-client",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: marian/rebrow",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: marian/rebrow",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 5001",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5001",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: REDIS_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_HOST",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: redis-service",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: redis-service",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: REDIS_PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"6379\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"6379\"",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 24,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis-web-client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis-web-client",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: marian/rebrow",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: marian/rebrow",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 5001",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5001",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: REDIS_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_HOST",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: redis-service",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: redis-service",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: REDIS_PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"6379\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"6379\"",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"redis-web-client\" of deployment \"redis-web-client-deployment\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 24,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis-web-client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis-web-client",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: marian/rebrow",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: marian/rebrow",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 5001",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5001",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: REDIS_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_HOST",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: redis-service",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: redis-service",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: REDIS_PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REDIS_PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"6379\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"6379\"",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "src/kubernetes/dev_redis_deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 14,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV016",
          "AVDID": "AVD-KSV-0016",
          "Title": "Memory requests not specified",
          "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'resources.requests.memory'",
          "Namespace": "builtin.kubernetes.KSV016",
          "Query": "data.builtin.kubernetes.KSV016.deny",
          "Resolution": "Set 'containers[].resources.requests.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV018",
          "AVDID": "AVD-KSV-0018",
          "Title": "Memory not limited",
          "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'resources.limits.memory'",
          "Namespace": "builtin.kubernetes.KSV018",
          "Query": "data.builtin.kubernetes.KSV018.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv018"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"redis\" of deployment \"redis-deployment\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "src/kubernetes/dev_secrets_akv.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "src/kubernetes/prod_collectstatic_job.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 81,
        "Failures": 14,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 126,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 126,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 126,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 126,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 126,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 126,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 126,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV016",
          "AVDID": "AVD-KSV-0016",
          "Title": "Memory requests not specified",
          "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'resources.requests.memory'",
          "Namespace": "builtin.kubernetes.KSV016",
          "Query": "data.builtin.kubernetes.KSV016.deny",
          "Resolution": "Set 'containers[].resources.requests.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 126,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV018",
          "AVDID": "AVD-KSV-0018",
          "Title": "Memory not limited",
          "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'resources.limits.memory'",
          "Namespace": "builtin.kubernetes.KSV018",
          "Query": "data.builtin.kubernetes.KSV018.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv018"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 126,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 126,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 126,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 126,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"collectstatic\" of job \"collectstatic-job\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 126,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "src/kubernetes/prod_deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 12,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'fakeapp-backend-prod' of Deployment 'fakeapp-backend-prod' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 135,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-prod",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-prod",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'fakeapp-backend-prod' of Deployment 'fakeapp-backend-prod' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 135,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-prod",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-prod",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'fakeapp-backend-prod' of Deployment 'fakeapp-backend-prod' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 135,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-prod",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-prod",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'fakeapp-backend-prod' of Deployment 'fakeapp-backend-prod' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 135,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-prod",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-prod",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'fakeapp-backend-prod' of Deployment 'fakeapp-backend-prod' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 135,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-prod",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-prod",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'fakeapp-backend-prod' of Deployment 'fakeapp-backend-prod' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 135,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-prod",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-prod",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'fakeapp-backend-prod' of Deployment 'fakeapp-backend-prod' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 135,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-prod",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-prod",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'fakeapp-backend-prod' of Deployment 'fakeapp-backend-prod' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 135,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-prod",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-prod",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'fakeapp-backend-prod' of Deployment 'fakeapp-backend-prod' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 135,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-prod",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-prod",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 135,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-prod",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-prod",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"fakeapp-backend-prod\" of deployment \"fakeapp-backend-prod\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 135,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-prod",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-prod",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"1400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"1400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "src/kubernetes/prod_nginx_deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 14,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-prod' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-prod' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-prod' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-prod' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-prod' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-prod' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV016",
          "AVDID": "AVD-KSV-0016",
          "Title": "Memory requests not specified",
          "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-prod' should set 'resources.requests.memory'",
          "Namespace": "builtin.kubernetes.KSV016",
          "Query": "data.builtin.kubernetes.KSV016.deny",
          "Resolution": "Set 'containers[].resources.requests.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV018",
          "AVDID": "AVD-KSV-0018",
          "Title": "Memory not limited",
          "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-prod' should set 'resources.limits.memory'",
          "Namespace": "builtin.kubernetes.KSV018",
          "Query": "data.builtin.kubernetes.KSV018.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv018"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-prod' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-prod' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"nginx\" of deployment \"fake-nginx-prod\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV117",
          "AVDID": "AVD-KSV-0117",
          "Title": "Prevent binding to privileged ports",
          "Description": "The ports which are lower than 1024 receive and transmit various sensitive and privileged data. Allowing containers to use them can bring serious implications.",
          "Message": "deployment fake-nginx-prod in default namespace should not set spec.template.spec.containers.ports.containerPort to less than 1024",
          "Namespace": "builtin.kubernetes.KSV117",
          "Query": "data.builtin.kubernetes.KSV117.deny",
          "Resolution": "Do not map the container ports to privileged host ports when starting a container.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv117",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/",
            "https://avd.aquasec.com/misconfig/ksv117"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        }
      ]
    },
    {
      "Target": "src/kubernetes/prod_pvolumen_fs.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "src/kubernetes/prod_redis_deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 14,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV016",
          "AVDID": "AVD-KSV-0016",
          "Title": "Memory requests not specified",
          "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'resources.requests.memory'",
          "Namespace": "builtin.kubernetes.KSV016",
          "Query": "data.builtin.kubernetes.KSV016.deny",
          "Resolution": "Set 'containers[].resources.requests.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV018",
          "AVDID": "AVD-KSV-0018",
          "Title": "Memory not limited",
          "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'resources.limits.memory'",
          "Namespace": "builtin.kubernetes.KSV018",
          "Query": "data.builtin.kubernetes.KSV018.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv018"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"redis\" of deployment \"redis-deployment\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "src/kubernetes/prod_secrets_akv.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "src/kubernetes/qa_autoscaler_deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "src/kubernetes/qa_celery_worker.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 83,
        "Failures": 12,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'fakeapp-celery-worker-qa' of Deployment 'fakeapp-celery-worker-qa' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'fakeapp-celery-worker-qa' of Deployment 'fakeapp-celery-worker-qa' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'fakeapp-celery-worker-qa' of Deployment 'fakeapp-celery-worker-qa' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'fakeapp-celery-worker-qa' of Deployment 'fakeapp-celery-worker-qa' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'fakeapp-celery-worker-qa' of Deployment 'fakeapp-celery-worker-qa' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'fakeapp-celery-worker-qa' of Deployment 'fakeapp-celery-worker-qa' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'fakeapp-celery-worker-qa' of Deployment 'fakeapp-celery-worker-qa' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'fakeapp-celery-worker-qa' of Deployment 'fakeapp-celery-worker-qa' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'fakeapp-celery-worker-qa' of Deployment 'fakeapp-celery-worker-qa' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"fakeapp-celery-worker-qa\" of deployment \"fakeapp-celery-worker-qa\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 230,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-worker-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-worker-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', '-A', 'fake', 'worker', '-l', 'INFO']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m, \u001b[38;5;37m'worker'\u001b[0m, \u001b[38;5;37m'-l'\u001b[0m, \u001b[38;5;37m'INFO'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "src/kubernetes/qa_collectstatic_job.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 81,
        "Failures": 14,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV016",
          "AVDID": "AVD-KSV-0016",
          "Title": "Memory requests not specified",
          "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'resources.requests.memory'",
          "Namespace": "builtin.kubernetes.KSV016",
          "Query": "data.builtin.kubernetes.KSV016.deny",
          "Resolution": "Set 'containers[].resources.requests.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV018",
          "AVDID": "AVD-KSV-0018",
          "Title": "Memory not limited",
          "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'resources.limits.memory'",
          "Namespace": "builtin.kubernetes.KSV018",
          "Query": "data.builtin.kubernetes.KSV018.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv018"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'collectstatic' of Job 'collectstatic-job' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"collectstatic\" of job \"collectstatic-job\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 9,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "      - name: collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: collectstatic",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          pwd \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          pwd \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          ls \u0026\u0026",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          ls \u0026\u0026",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "          python3 manage.py collectstatic",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          python3 manage.py collectstatic\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        workingDir: /opt/backend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mworkingDir\u001b[0m: /opt/backend",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "src/kubernetes/qa_deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 12,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'fakeapp-backend-qa' of Deployment 'fakeapp-backend-qa' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"2400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"2400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'fakeapp-backend-qa' of Deployment 'fakeapp-backend-qa' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"2400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"2400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'fakeapp-backend-qa' of Deployment 'fakeapp-backend-qa' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"2400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"2400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'fakeapp-backend-qa' of Deployment 'fakeapp-backend-qa' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"2400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"2400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'fakeapp-backend-qa' of Deployment 'fakeapp-backend-qa' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"2400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"2400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'fakeapp-backend-qa' of Deployment 'fakeapp-backend-qa' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"2400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"2400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'fakeapp-backend-qa' of Deployment 'fakeapp-backend-qa' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"2400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"2400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'fakeapp-backend-qa' of Deployment 'fakeapp-backend-qa' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"2400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"2400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'fakeapp-backend-qa' of Deployment 'fakeapp-backend-qa' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"2400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"2400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"2400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"2400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"fakeapp-backend-qa\" of deployment \"fakeapp-backend-qa\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 307,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-backend-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-backend-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "            memory: \"2400Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"2400Mi\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "src/kubernetes/qa_flower_deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 12,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'fakeapp-celery-flower-qa' of Deployment 'fakeapp-celery-flower-qa' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 232,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'fakeapp-celery-flower-qa' of Deployment 'fakeapp-celery-flower-qa' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 232,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'fakeapp-celery-flower-qa' of Deployment 'fakeapp-celery-flower-qa' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 232,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'fakeapp-celery-flower-qa' of Deployment 'fakeapp-celery-flower-qa' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 232,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'fakeapp-celery-flower-qa' of Deployment 'fakeapp-celery-flower-qa' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 232,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'fakeapp-celery-flower-qa' of Deployment 'fakeapp-celery-flower-qa' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 232,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'fakeapp-celery-flower-qa' of Deployment 'fakeapp-celery-flower-qa' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 232,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'fakeapp-celery-flower-qa' of Deployment 'fakeapp-celery-flower-qa' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 232,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'fakeapp-celery-flower-qa' of Deployment 'fakeapp-celery-flower-qa' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 232,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 232,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"fakeapp-celery-flower-qa\" of deployment \"fakeapp-celery-flower-qa\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 232,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: fakeapp-celery-flower-qa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: fakeapp-celery-flower-qa",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: fakeappcr.azurecr.io/fake_backend_qa:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        command: ['celery', 'flower', '-A', 'fake']",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m'celery'\u001b[0m, \u001b[38;5;37m'flower'\u001b[0m, \u001b[38;5;37m'-A'\u001b[0m, \u001b[38;5;37m'fake'\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - containerPort: 5555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "              memory: \"700Mi\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: \u001b[38;5;37m\"700Mi\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          limits:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mlimits\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "src/kubernetes/qa_nginx_deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 14,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-qa' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-qa' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-qa' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-qa' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-qa' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-qa' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV016",
          "AVDID": "AVD-KSV-0016",
          "Title": "Memory requests not specified",
          "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-qa' should set 'resources.requests.memory'",
          "Namespace": "builtin.kubernetes.KSV016",
          "Query": "data.builtin.kubernetes.KSV016.deny",
          "Resolution": "Set 'containers[].resources.requests.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV018",
          "AVDID": "AVD-KSV-0018",
          "Title": "Memory not limited",
          "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-qa' should set 'resources.limits.memory'",
          "Namespace": "builtin.kubernetes.KSV018",
          "Query": "data.builtin.kubernetes.KSV018.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv018"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-qa' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'nginx' of Deployment 'fake-nginx-qa' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"nginx\" of deployment \"fake-nginx-qa\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "        - name: nginx",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: nginx",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "          image: nginx:1.21.1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: nginx:1.21.1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "            - name: config-volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: config-volume",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              mountPath: /etc/nginx/conf.d",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmountPath\u001b[0m: /etc/nginx/conf.d",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV117",
          "AVDID": "AVD-KSV-0117",
          "Title": "Prevent binding to privileged ports",
          "Description": "The ports which are lower than 1024 receive and transmit various sensitive and privileged data. Allowing containers to use them can bring serious implications.",
          "Message": "deployment fake-nginx-qa in default namespace should not set spec.template.spec.containers.ports.containerPort to less than 1024",
          "Namespace": "builtin.kubernetes.KSV117",
          "Query": "data.builtin.kubernetes.KSV117.deny",
          "Resolution": "Do not map the container ports to privileged host ports when starting a container.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv117",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/",
            "https://avd.aquasec.com/misconfig/ksv117"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        }
      ]
    },
    {
      "Target": "src/kubernetes/qa_pvolumen_fs.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "src/kubernetes/qa_redis_deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 14,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'redis' of Deployment 'redis-deployment-qa' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'redis' of Deployment 'redis-deployment-qa' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'redis' of Deployment 'redis-deployment-qa' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'redis' of Deployment 'redis-deployment-qa' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'redis' of Deployment 'redis-deployment-qa' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'redis' of Deployment 'redis-deployment-qa' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'redis' of Deployment 'redis-deployment-qa' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV016",
          "AVDID": "AVD-KSV-0016",
          "Title": "Memory requests not specified",
          "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'redis' of Deployment 'redis-deployment-qa' should set 'resources.requests.memory'",
          "Namespace": "builtin.kubernetes.KSV016",
          "Query": "data.builtin.kubernetes.KSV016.deny",
          "Resolution": "Set 'containers[].resources.requests.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV018",
          "AVDID": "AVD-KSV-0018",
          "Title": "Memory not limited",
          "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
          "Message": "Container 'redis' of Deployment 'redis-deployment-qa' should set 'resources.limits.memory'",
          "Namespace": "builtin.kubernetes.KSV018",
          "Query": "data.builtin.kubernetes.KSV018.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv018"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'redis' of Deployment 'redis-deployment-qa' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'redis' of Deployment 'redis-deployment-qa' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"redis\" of deployment \"redis-deployment-qa\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis/redis-stack-server:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis/redis-stack-server:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "src/kubernetes/qa_secrets_akv.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "src/kubernetes/redis_deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 13,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV016",
          "AVDID": "AVD-KSV-0016",
          "Title": "Memory requests not specified",
          "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'resources.requests.memory'",
          "Namespace": "builtin.kubernetes.KSV016",
          "Query": "data.builtin.kubernetes.KSV016.deny",
          "Resolution": "Set 'containers[].resources.requests.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV018",
          "AVDID": "AVD-KSV-0018",
          "Title": "Memory not limited",
          "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'resources.limits.memory'",
          "Namespace": "builtin.kubernetes.KSV018",
          "Query": "data.builtin.kubernetes.KSV018.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv018"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'redis' of Deployment 'redis-deployment' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"redis\" of deployment \"redis-deployment\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "src/kubernetes/redis_deployment_qa.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 95,
        "Failures": 13,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'redis' of Deployment 'redis-deployment-qa' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'redis' of Deployment 'redis-deployment-qa' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'redis' of Deployment 'redis-deployment-qa' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'redis' of Deployment 'redis-deployment-qa' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'redis' of Deployment 'redis-deployment-qa' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'redis' of Deployment 'redis-deployment-qa' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV016",
          "AVDID": "AVD-KSV-0016",
          "Title": "Memory requests not specified",
          "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'redis' of Deployment 'redis-deployment-qa' should set 'resources.requests.memory'",
          "Namespace": "builtin.kubernetes.KSV016",
          "Query": "data.builtin.kubernetes.KSV016.deny",
          "Resolution": "Set 'containers[].resources.requests.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV018",
          "AVDID": "AVD-KSV-0018",
          "Title": "Memory not limited",
          "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
          "Message": "Container 'redis' of Deployment 'redis-deployment-qa' should set 'resources.limits.memory'",
          "Namespace": "builtin.kubernetes.KSV018",
          "Query": "data.builtin.kubernetes.KSV018.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv018"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'redis' of Deployment 'redis-deployment-qa' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
          "Message": "Container 'redis' of Deployment 'redis-deployment-qa' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"redis\" of deployment \"redis-deployment-qa\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 16,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "      - name: redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        image: redis:5.0.7-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:5.0.7-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - containerPort: 6379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": ".env",
      "Class": "secret",
      "Secrets": [
        {
          "RuleID": "github-pat",
          "Category": "GitHub",
          "Severity": "CRITICAL",
          "Title": "GitHub Personal Access Token",
          "StartLine": 3,
          "EndLine": 3,
          "Code": {
            "Lines": [
              {
                "Number": 1,
                "Content": "# Settings",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "# Settings",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 2,
                "Content": "DJANGO_SETTINGS_MODULE=fake.settings.api",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "DJANGO_SETTINGS_MODULE=fake.settings.api",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 3,
                "Content": "GIT_TOKEN=****************************************",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "GIT_TOKEN=****************************************",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 4,
                "Content": "MODEL_VERSION=development",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "MODEL_VERSION=development",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Match": "GIT_TOKEN=****************************************",
          "Layer": {}
        }
      ]
    }
  ]
}
